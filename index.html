<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Course Player</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            margin: 0;
            background-color: var(--tg-theme-bg-color, #1c1c1d);
            color: var(--tg-theme-text-color, #ffffff);
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }
        video {
            width: 95%;
            max-height: 60vh;
            border-radius: 12px;
            background: #000;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        .controls {
            margin-top: 25px;
            display: grid;
            grid-template-columns: repeat(3, 1fr); /* 3 –∫–Ω–æ–ø–∫–∏ –≤ —Ä—è–¥ */
            gap: 10px;
            width: 90%;
        }
        button {
            background: var(--tg-theme-button-color, #3390ec);
            color: var(--tg-theme-button-text-color, #ffffff);
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            opacity: 0.6; /* –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ */
            transition: 0.2s;
        }
        /* –°—Ç–∏–ª—å –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–π –∫–Ω–æ–ø–∫–∏ —è–∑—ã–∫–∞ */
        button.active {
            opacity: 1;
            transform: scale(1.05);
            box-shadow: 0 0 10px var(--tg-theme-button-color);
        }
        h2 { margin-bottom: 10px; font-size: 18px; }
    </style>
</head>
<body>

    <h2 id="title">–ó–∞–≥—Ä—É–∑–∫–∞...</h2>

    <video id="mainVideo" controls playsinline>
        <source src="" type="video/mp4">
    </video>

    <div class="controls">
        <button onclick="changeLang('ru')" id="btn-ru">üá∑üá∫ RU</button>
        <button onclick="changeLang('en')" id="btn-en">üá¨üáß EN</button>
        <button onclick="changeLang('es')" id="btn-es">üá™üá∏ ES</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand(); 

        // --- –ë–ê–ó–ê –î–ê–ù–ù–´–• –í–ê–®–ò–• –í–ò–î–ï–û (–î–†–û–ü–ë–û–ö–°) ---
        // –í—Å—Ç–∞–≤–ª—è–π—Ç–µ —Å—é–¥–∞ —Å—Å—ã–ª–∫–∏ —Å raw=1
        const videoDatabase = {
            "1": { // –£—Ä–æ–∫ 1
                "title": "–£—Ä–æ–∫ 1: –í–≤–µ–¥–µ–Ω–∏–µ",
                "ru": "https://www.dropbox.com/s/YOUR_LINK_RU?raw=1", 
                "en": "https://www.dropbox.com/s/YOUR_LINK_EN?raw=1",
                "es": "https://www.dropbox.com/s/YOUR_LINK_ES?raw=1"
            },
            "2": { // –£—Ä–æ–∫ 2
                "title": "–£—Ä–æ–∫ 2: –°–±–æ—Ä–∫–∞",
                "ru": "https://www.dropbox.com/s/ANOTHER_LINK_RU?raw=1",
                "en": "https://www.dropbox.com/s/ANOTHER_LINK_EN?raw=1",
                "es": "https://www.dropbox.com/s/ANOTHER_LINK_ES?raw=1"
            }
        };

        // –ü–æ–ª—É—á–∞–µ–º –Ω–æ–º–µ—Ä —É—Ä–æ–∫–∞ –∏–∑ URL (?lesson=1)
        const urlParams = new URLSearchParams(window.location.search);
        const lessonId = urlParams.get('lesson') || '1'; 
        
        // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ —É—Ä–æ–∫–∞
        const currentLesson = videoDatabase[lessonId];
        const videoElement = document.getElementById('mainVideo');
        
        // –°—Ç–∞–≤–∏–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
        if(currentLesson) {
            document.getElementById('title').innerText = currentLesson.title;
        }

        // –§—É–Ω–∫—Ü–∏—è —Å–º–µ–Ω—ã —è–∑—ã–∫–∞
        function changeLang(lang) {
            if (!currentLesson) return;

            const newSrc = currentLesson[lang];
            const currentTime = videoElement.currentTime;
            const wasPlaying = !videoElement.paused;

            videoElement.src = newSrc;
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Ä–µ–º—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
            videoElement.currentTime = currentTime;
            if (wasPlaying) videoElement.play();

            // –í–∏–∑—É–∞–ª –∫–Ω–æ–ø–æ–∫
            document.querySelectorAll('button').forEach(b => b.classList.remove('active'));
            document.getElementById(`btn-${lang}`).classList.add('active');
        }

        // –ó–∞–ø—É—Å–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–†—É—Å—Å–∫–∏–π)
        changeLang('ru');

    </script>
</body>
</html>
